Notebook[{Cell[
BoxData[RowBox[{RowBox[{"f","[",RowBox[{"p_",",","q_"}],"]"}],":=",RowBox[
{RowBox[{"a","*",RowBox[{"p","^","2"}]}],"+",RowBox[{"b","*","p"}],"+","c"}]}]],"Input",
CellLabel -> "In[63]:= ",ExpressionUUID -> "46bd282e-b1c4-4cc1-967c-758e236bbd98"],Cell[
BoxData[
RowBox[{RowBox[{"g","[",RowBox[{"p_",",","q_"}],"]"}],":=",RowBox[{RowBox[{"d","*",RowBox[
{"q","^","2"}]}],"+",RowBox[{"e","*","q"}],"+","f"}]}]],"Input",CellLabel -> "In[65]:= ",
ExpressionUUID -> "e8017ac6-7d17-4845-85c5-600cc68bb3ea"],Cell[
BoxData[RowBox[{RowBox[
{"f1","[",RowBox[{"p_",",","q_"}],"]"}],":=",RowBox[{"Log","[",RowBox[{"Exp","[",RowBox[
{"a","*","p"}],"]"}],"]"}]}]],"Input",CellLabel -> "In[66]:= ",ExpressionUUID -> "58aca346-078f-48a8-bde6-17a891a2cc17"],Cell[
BoxData[
RowBox[{RowBox[{"g1","[",RowBox[{"p_",",","q_"}],"]"}],":=",RowBox[{"Log","[",RowBox[
{"Exp","[",RowBox[{"b","*","q"}],"]"}],"]"}]}]],"Input",CellLabel -> "In[67]:= ",
ExpressionUUID -> "70ce7331-234c-4ed4-b3c7-9f28170334a5"],Cell[
BoxData[RowBox[{RowBox[
{"f2","[",RowBox[{"p_",",","q_"}],"]"}],":=",RowBox[{"Log","[",RowBox[{RowBox[{"Exp","[",RowBox[
{"a","*","p"}],"]"}],"+",RowBox[{"Exp","[",RowBox[{"b","*","p"}],"]"}]}],"]"}]}]],
"Input",CellLabel -> "In[68]:= ",ExpressionUUID -> "bc4ef896-a153-436f-a647-74fac1949433"],Cell[
BoxData[
RowBox[{RowBox[{"g2","[",RowBox[{"p_",",","q_"}],"]"}],":=",RowBox[{"Log","[",RowBox[
{RowBox[{"Exp","[",RowBox[{"a","*","q"}],"]"}],"+",RowBox[{"Exp","[",RowBox[{"b","*","q"}],"]"}]}],"]"}]}]],
"Input",CellLabel -> "In[69]:= ",ExpressionUUID -> "209a4f6c-f6a7-4ded-898d-057c6a975918"],Cell[
BoxData[
RowBox[{RowBox[{"f3","[",RowBox[{"p_",",","q_"}],"]"}],":=",RowBox[{"Log","[",RowBox[
{RowBox[{"Exp","[",RowBox[{"a","*","p"}],"]"}],"+",RowBox[{"Exp","[",RowBox[{"b","*","p"}],"]"}],"+",RowBox[
{"Exp","[",RowBox[{"c","*","p"}],"]"}]}],"]"}]}]],"Input",CellLabel -> "In[70]:= ",
ExpressionUUID -> "9a00f159-9cc4-423c-a05f-0fafd2ab3184"],Cell[
BoxData[RowBox[{RowBox[
{"g3","[",RowBox[{"p_",",","q_"}],"]"}],":=",RowBox[{"Log","[",RowBox[{RowBox[{"Exp","[",RowBox[
{"a","*","q"}],"]"}],"+",RowBox[{"Exp","[",RowBox[{"b","*","q"}],"]"}],"+",RowBox[
{"Exp","[",RowBox[{"c","*","q"}],"]"}]}],"]"}]}]],"Input",CellLabel -> "In[71]:= ",
ExpressionUUID -> "e6499953-6256-4ab8-96fd-751dc1adb8b2"],Cell[
BoxData[RowBox[{RowBox[
{"expf1","[",RowBox[{"p_",",","q_"}],"]"}],":=",RowBox[{"a","*",RowBox[{"Exp","[",RowBox[
{"b","*","p"}],"]"}]}]}]],"Input",CellLabel -> "In[72]:= ",ExpressionUUID -> "7f700049-08cf-420e-8893-fbc7183c0092"],Cell[
BoxData[
RowBox[{RowBox[{"expg1","[",RowBox[{"p_",",","q_"}],"]"}],":=",RowBox[{"c","*",RowBox[
{"Exp","[",RowBox[{"d","*","q"}],"]"}]}]}]],"Input",CellLabel -> "In[73]:= ",ExpressionUUID -> "da80ba9f-a05a-45ba-92c9-9d3637c36cc8"],Cell[
TextData[
{"Poisson"," ","bracket"," ","in"," ","1D","."}],"Item",ExpressionUUID -> "a88a8974-6911-4326-9b21-94f4183fd746"],Cell[
BoxData[
RowBox[{RowBox[{"PoissonBracket1D","[",RowBox[{"func_",",","gunc_",","," ","p_",",","q_"}],"]"}]," ",":="," ",RowBox[
{RowBox[{RowBox[{"D","[",RowBox[{RowBox[{"func","[",RowBox[{"p",",","q"}],"]"}],",","q"}],"]"}],"*",RowBox[
{"D","[",RowBox[{RowBox[{"gunc","[",RowBox[{"p",",","q"}],"]"}],",","p"}],"]"}]}],"-",RowBox[
{RowBox[{"D","[",RowBox[{RowBox[{"func","[",RowBox[{"p",",","q"}],"]"}],",","p"}],"]"}],"*",RowBox[
{"D","[",RowBox[{RowBox[{"gunc","[",RowBox[{"p",",","q"}],"]"}],",","q"}],"]"}]}]}]}]],
"Input",CellLabel -> "In[74]:= ",ExpressionUUID -> "ddb953a2-fa25-4ab1-a016-b15a8f919f6a"],Cell[
TextData[
{"Poisson"," ","bracket",StyleBox[RowBox[{" ","("}]],"in"," ","1D",StyleBox[RowBox[
{","," "}]],"as"," ","it"," ","will"," ","be"," ","from"," ","now"," ","on",StyleBox[
RowBox[{")"," "}]],"nested"," ","against"," ","the"," ","same"," ","function"," ","ri"," ","times","."}],
"Item",ExpressionUUID -> "432e180a-1479-4807-829f-84ac43c32a4c"],Cell[
BoxData[RowBox[
{RowBox[{"PoissonNest1D","[",RowBox[{"prev_",",","Func_",",","p_",",","q_",",","ri_"}],"]"}]," ",":=",RowBox[
{"Nest","[",RowBox[{RowBox[{RowBox[{"PoissonBracket1D","[",RowBox[{RowBox[{"Function","[",RowBox[
{RowBox[{"{",RowBox[{"p",",","q"}],"}"}],",","#"}],"]"}],","," ","Func",","," ","p",",","q"}],"]"}]," ","&"}],","," ",RowBox[
{"prev","[",RowBox[{"p",",","q"}],"]"}],","," ","ri"}],"]"}]}]],"Input",CellLabel -> "In[75]:= ",
ExpressionUUID -> "3599baab-b007-435f-8588-3329e5885890"],Cell[
TextData[{"Poisson"," ","bracket"," ","nested"," ","against"," ","two"," ","separate"," ","functions",StyleBox[
RowBox[{","," "}]],"one",StyleBox[RowBox[{" ","("}]],"func",StyleBox[RowBox[{")"," "}]],"s_i"," ","times"," ","then"," ","the"," ","other",StyleBox[
RowBox[{" ","("}]],"gunc",StyleBox[RowBox[{")"," "}]],"r_i"," ","times","."}],"Item",
ExpressionUUID -> "c67cddd3-daba-4e67-bc81-8bbec6ca398f"],Cell[
BoxData[RowBox[{RowBox[
{"PairedPoissonNest1D","[",RowBox[{"prev_",",","func_",",","gunc_",",","p_",",","q_",",","ri_",",","si_"}],"]"}],":=",RowBox[
{"If","[",RowBox[{RowBox[{"ri","==","0"}],",",RowBox[{"PoissonNest1D","[",RowBox[
{"prev",",","func",",","p",",","q",",","si"}],"]"}]," ",",",RowBox[{"If","[",RowBox[
{RowBox[{"si","==","0"}],",",RowBox[{"PoissonNest1D","[",RowBox[{"prev",",","gunc",",","p",",","q",",","ri"}],"]"}],",",RowBox[
{"PoissonNest1D","[",RowBox[{RowBox[{"Function","[",RowBox[{RowBox[{"{",RowBox[{"p",",","q"}],"}"}],",",RowBox[
{"PoissonNest1D","[",RowBox[{"prev",",","func",",","p",",","q",",","si"}],"]"}]}]," ","]"}],",","gunc",",","p",",","q",",","ri"}],"]"}]}],"]"}]}],"]"}]}]],
"Input",CellLabel -> "In[76]:= ",ExpressionUUID -> "9dd79cc0-6a65-42e9-983b-e7e407578bfd"],Cell[
TextData[
{"The"," ","initialization"," ","for"," ","the"," ","nested"," ","Poisson"," ","brackets",":"}],
"Item",ExpressionUUID -> "66cd36db-134a-4742-8d0c-868d26ba6a8c"],Cell[
BoxData[RowBox[
{RowBox[{"PairedPoissonNestinit1D","[",RowBox[{"func_",",","gunc_",",","p_",",","q_",",","rn_",",","sn_"}],"]"}],":=",RowBox[
{"If","[",RowBox[{RowBox[{"sn","==","0"}],",",RowBox[{"If","[",RowBox[{RowBox[{"rn","==","1"}],",",RowBox[
{"gunc","[",RowBox[{"p",",","q"}],"]"}],",","0"}],"]"}],",",RowBox[{"PairedPoissonNest1D","[",RowBox[
{"func",",","func",",","gunc",",","p",",","q",",","rn",",",RowBox[{"sn","-","1"}]}],"]"}]}],"]"}]}]],
"Input",CellLabel -> "In[77]:= ",ExpressionUUID -> "d6146aa2-1767-488f-b94d-4f8b5644451e"],Cell[
TextData[
{"Computation"," ","of"," ","nested"," ","Poisson"," ","bracket",StyleBox[RowBox[
{"."," "}]],"r_1",",...,","r_n"," ","and"," ","s_1",",...,","s_n"," ","are"," ","in"," ","reverse"," ","order"," ","because"," ","it"," ","makes"," ","the"," ","indexing"," ","easier",StyleBox[
RowBox[{" ","("}]],"and"," ","does"," ","not"," ","really"," ","change"," ","our"," ","computations"," ","of"," ","the"," ","formulae"," ","later"," ","on",")."}],
"Item",ExpressionUUID -> "3cd1bdef-cc67-4e16-a0d5-4f9be7d65c7a"],Cell[
BoxData[RowBox[
{RowBox[{"NestedPoisson1D","[",RowBox[{"func_",",","gunc_",",","p_",",","q_",",","r_",",","s_"}],"]"}],":=",RowBox[
{"If","[",RowBox[{RowBox[{RowBox[{"Min","[",RowBox[{RowBox[{"Length","[","r","]"}],",",RowBox[
{"Length","[","s","]"}]}],"]"}],"==","1"}],",",RowBox[{"PairedPoissonNestinit1D","[",RowBox[
{"func",",","gunc",",","p",",","q",",",RowBox[{"r","[",RowBox[{"[","1","]"}],"]"}],",",RowBox[
{"s","[",RowBox[{"[","1","]"}],"]"}]}],"]"}],",",RowBox[{"Fold","[",RowBox[{RowBox[
{RowBox[{"PairedPoissonNest1D","[",RowBox[{RowBox[{"Function","[",RowBox[{RowBox[
{"{",RowBox[{"p",",","q"}],"}"}],",","#1"}],"]"}],",","func",",","gunc",",","p",",","q",",",RowBox[
{"Part","[",RowBox[{"#2",","," ","1"}],"]"}],",",RowBox[{"Part","[",RowBox[{"#2",","," ","2"}],"]"}]}],"]"}],"&"}],",",RowBox[
{"PairedPoissonNestinit1D","[",RowBox[{"func",",","gunc",",","p",",","q",",",RowBox[
{"r","[",RowBox[{"[","1","]"}],"]"}],",",RowBox[{"s","[",RowBox[{"[","1","]"}],"]"}]}],"]"}],",",RowBox[
{"Transpose","[",RowBox[{"{",RowBox[{RowBox[{"r","[",RowBox[{"[",RowBox[{"2"," ",";;"}],"]"}],"]"}],",",RowBox[
{"s","[",RowBox[{"[",RowBox[{"2"," ",";;"}],"]"}],"]"}]}],"}"}],"]"}]}],"]"}]}],"]"}]}]],
"Input",CellLabel -> "In[78]:= ",ExpressionUUID -> "683b6046-0a68-4a06-b38f-ecdaf1852e57"],Cell[
TextData[
{"The"," ","innermost"," ","term"," ","for"," ","the"," ","Baker-Campbell-Hausdorff"," ","formula",StyleBox[
RowBox[{" ","("}]],"rearranged"," ","order-by-order",StyleBox[RowBox[{","," "}]],"equation",StyleBox[
RowBox[{" ","("}]],"69","))."}],"Item",ExpressionUUID -> "b7d182cb-a1ba-4796-8e33-e2fec7b313ef"],Cell[
BoxData[
RowBox[{RowBox[{"BCH31D","[",RowBox[{"func_",",","gunc_",",","p_",",","q_",",","r_",",","s_"}],"]"}],":=",RowBox[
{RowBox[{"NestedPoisson1D","[",RowBox[{"func",",","gunc",",","p",",","q",",","r",",","s"}],"]"}],"/",RowBox[
{"(",RowBox[{RowBox[{"(",RowBox[{"Times"," ","@@",RowBox[{"(",RowBox[{RowBox[{"Function","[",RowBox[
{"x",","," ",RowBox[{"x","!"}]}],"]"}]," ","/@","r"}],")"}]}],")"}],"*",RowBox[{"(",RowBox[
{"Times"," ","@@",RowBox[{"(",RowBox[{RowBox[{"Function","[",RowBox[{"x",","," ",RowBox[
{"x","!"}]}],"]"}]," ","/@","s"}],")"}]}],")"}]}],")"}]}]}]],"Input",CellLabel -> "In[79]:= ",
ExpressionUUID -> "2efc1056-c178-48b3-9255-c7f419cdcd29"],Cell[
TextData[{"Compute"," ","all"," ","permitted"," ","integer"," ","partitions"," ","of",StyleBox[
RowBox[{" ","{"}]],"r_1",",...,","r_n",StyleBox[RowBox[{"}"," "}]],"and",StyleBox[
RowBox[{" ","{"}]],"s_1",",...,","s_n",StyleBox[RowBox[{"}"," "}]],"to"," ","sum"," ","over"," ","for"," ","the"," ","innermost"," ","sum"," ","in"," ","the"," ","BCH"," ","formula",StyleBox[
RowBox[{","," "}]],"then"," ","evaluate"," ","each"," ","of"," ","these"," ","at"," ","the"," ","functions"," ","f"," ","and"," ","g"," ","and"," ","sum","."}],
"Item",ExpressionUUID -> "a299fd68-c989-49d2-8c90-d51d83968c5a"],Cell[
BoxData[RowBox[
{RowBox[{"sumintpart","[",RowBox[{"func_",",","gunc_",",","p_",",","q_",",","k_",",","n_"}],"]"}],":=",RowBox[
{"Module","[",RowBox[{RowBox[{"{","perm","}"}],",","\n",RowBox[{RowBox[{"perm","=",RowBox[
{RowBox[{"Function","[",RowBox[{"Select","[",RowBox[{RowBox[{"Permutations","[","#","]"}],",",RowBox[
{"Function","[",RowBox[{RowBox[{"flag","=","True"}],";",RowBox[{"Do","[",RowBox[{RowBox[
{"If","[",RowBox[{RowBox[{RowBox[{RowBox[{"#","[",RowBox[{"[","j","]"}],"]"}],"==","1"}],"&&",RowBox[
{RowBox[{"#","[",RowBox[{"[",RowBox[{"n","+","j"}],"]"}],"]"}],"==","1"}]}],",",RowBox[
{RowBox[{"flag","=","False"}],";",RowBox[{"Break","[","]"}]}]}],"]"}],",",RowBox[
{"{",RowBox[{"j",",","n"}],"}"}]}],"]"}],";","flag"}],"]"}]}],"]"}],"]"}]," ","/@"," ",RowBox[
{"IntegerPartitions","[",RowBox[{RowBox[{"k","+",RowBox[{"2","*","n"}]}],",",RowBox[
{"{",RowBox[{"2","*","n"}],"}"}]}],"]"}]}]}],";",RowBox[{"perm","=",RowBox[{RowBox[
{"Flatten","[",RowBox[{"perm",",","1"}],"]"}],"-","1"}]}],";","\n",RowBox[{"Sum","[",RowBox[
{RowBox[{"BCH31D","[",RowBox[{"func",",","gunc",",","p",",","q",",",RowBox[{RowBox[
{"perm","[",RowBox[{"[","i","]"}],"]"}],"[",RowBox[{"[",RowBox[{";;"," ","n"}],"]"}],"]"}],",",RowBox[
{RowBox[{"perm","[",RowBox[{"[","i","]"}],"]"}],"[",RowBox[{"[",RowBox[{RowBox[{"n","+","1"}],";;"}],"]"}],"]"}]}],"]"}],",",RowBox[
{"{",RowBox[{"i",",",RowBox[{"Length","[","perm","]"}]}],"}"}]}],"]"}]}]}],"]"}]}]],
"Input",CellLabel -> "In[80]:= ",ExpressionUUID -> "f9a40a89-af36-4e4b-81ff-ac3e7617c7c6"],Cell[
TextData[
{"Sum"," ","up"," ","all"," ","innermost"," ","terms"," ","for"," ","the"," ","BCH"," ","formula"," ","and"," ","multiply"," ","by"," ","common"," ","factor"," ","in"," ","n"," ","to"," ","evaluate"," ","second"," ","innermost"," ","term"," ","for"," ","the"," ","BCH"," ","formula","."}],
"Item",ExpressionUUID -> "632b7e1b-ffd7-4f75-b878-02da4a64ccae"],Cell[
BoxData[RowBox[
{RowBox[{"BCH21D","[",RowBox[{"func_",",","gunc_",",","p_",",","q_",",","k_",",","n_"}],"]"}],":=",RowBox[
{RowBox[{"(",RowBox[{RowBox[{"(",RowBox[{"-","1"}],")"}],"^",RowBox[{"(",RowBox[{"n","-","1"}],")"}]}],")"}],"*",RowBox[
{RowBox[{"sumintpart","[",RowBox[{"func",",","gunc",",","p",",","q",",","k",",","n"}],"]"}],"/","n"}]}]}]],
"Input",CellLabel -> "In[81]:= ",ExpressionUUID -> "067922ad-aa82-4c0f-b810-91f38d47bbd2"],Cell[
TextData[
{"Evaluate",StyleBox[RowBox[{" ","("}]],"N-1",")","th-order"," ","correction"," ","to"," ","the"," ","modified"," ","Hamiltonian","."}],
"Item",ExpressionUUID -> "2f7412f2-89ce-4fa4-bd1e-4b65a9bb75da"],Cell[
BoxData[RowBox[
{RowBox[{"HamiltonianNth","[",RowBox[{"func_",",","gunc_",",","p_",",","q_",",","\[Eta]_",",","N_"}],"]"}],":=",RowBox[
{RowBox[{"\[Eta]","^",RowBox[{"(",RowBox[{"N","-","1"}],")"}]}],"*",RowBox[{RowBox[
{"Simplify","[",RowBox[{"Sum","[",RowBox[{RowBox[{"BCH21D","[",RowBox[{"func",",","gunc",",","p",",","q",",","N",",","n"}],"]"}]," ",",",RowBox[
{"{",RowBox[{"n",","," ","N"}],"}"}]}],"]"}],"]"}],"/","N"}]}]}]],"Input",CellLabel -> "In[82]:= ",
ExpressionUUID -> "dd04d2e1-afb5-43c5-ad2e-7d391617d361"],Cell[
TextData[{"Compute"," ","the"," ","Nth-order"," ","modified"," ","Hamiltonian","."}],
"Item",ExpressionUUID -> "32d805e3-6f69-4b44-9c21-43daf6ffe7f3"],Cell[
BoxData[RowBox[
{RowBox[{"NthHamiltonian","[",RowBox[{"func_",",","gunc_",",","p_",",","q_",",","\[Eta]_",",","N_"}],"]"}],":=",RowBox[
{"Sum","[",RowBox[{RowBox[{"HamiltonianNth","[",RowBox[{"func",",","gunc",",","p",",","q",",","\[Eta]",",","n"}],"]"}]," ",",",RowBox[
{"{",RowBox[{"n",","," ",RowBox[{"N","+","1"}]}],"}"}]}],"]"}]}]],"Input",CellLabel -> "In[83]:= ",
ExpressionUUID -> "17e6e49d-a247-4bd4-afa8-198101a6a650"],Cell[
TextData[{"Test"," ","cases",":"}],
"Item",ExpressionUUID -> "aac6eca2-9538-469d-a3a4-55f4aa921075"],Cell[
CellGroupData[
{Cell[
BoxData[RowBox[{"NthHamiltonian","[",RowBox[{"f",",","g",",","p",",","q",",","\[Eta]",",","8"}],"]"}]],
"Input",CellLabel -> "In[84]:= ",ExpressionUUID -> "0a11f819-422b-411e-a875-6fde2f305117"],Cell[
BoxData[
RowBox[{"c","+","f","+",RowBox[{"b"," ","p"}],"+",RowBox[{"a"," ",SuperscriptBox[
"p","2"]}],"+",RowBox[{"e"," ","q"}],"+",RowBox[{"d"," ",SuperscriptBox["q","2"]}],"-",RowBox[
{FractionBox["1","2"]," ",RowBox[{"(",RowBox[{"b","+",RowBox[{"2"," ","a"," ","p"}]}],")"}]," ",RowBox[
{"(",RowBox[{"e","+",RowBox[{"2"," ","d"," ","q"}]}],")"}]," ","\[Eta]"}],"+",RowBox[
{FractionBox["1","6"]," ",RowBox[{"(",RowBox[{RowBox[{"d"," ",SuperscriptBox[RowBox[
{"(",RowBox[{"b","+",RowBox[{"2"," ","a"," ","p"}]}],")"}],"2"]}],"+",RowBox[{"a"," ",SuperscriptBox[
RowBox[{"(",RowBox[{"e","+",RowBox[{"2"," ","d"," ","q"}]}],")"}],"2"]}]}],")"}]," ",SuperscriptBox[
"\[Eta]","2"]}],"-",RowBox[{FractionBox["1","3"]," ","a"," ","d"," ",RowBox[{"(",RowBox[
{"b","+",RowBox[{"2"," ","a"," ","p"}]}],")"}]," ",RowBox[{"(",RowBox[{"e","+",RowBox[
{"2"," ","d"," ","q"}]}],")"}]," ",SuperscriptBox["\[Eta]","3"]}],"+",RowBox[{FractionBox[
"2","15"]," ","a"," ","d"," ",RowBox[{"(",RowBox[{RowBox[{SuperscriptBox["b","2"]," ","d"}],"+",RowBox[
{"4"," ","a"," ","b"," ","d"," ","p"}],"+",RowBox[{"a"," ",RowBox[{"(",RowBox[{SuperscriptBox[
"e","2"],"+",RowBox[{"4"," ","d"," ","e"," ","q"}],"+",RowBox[{"4"," ","d"," ",RowBox[
{"(",RowBox[{RowBox[{"a"," ",SuperscriptBox["p","2"]}],"+",RowBox[{"d"," ",SuperscriptBox[
"q","2"]}]}],")"}]}]}],")"}]}]}],")"}]," ",SuperscriptBox["\[Eta]","4"]}],"-",RowBox[
{FractionBox["4","15"]," ",SuperscriptBox["a","2"]," ",SuperscriptBox["d","2"]," ",RowBox[
{"(",RowBox[{"b","+",RowBox[{"2"," ","a"," ","p"}]}],")"}]," ",RowBox[{"(",RowBox[
{"e","+",RowBox[{"2"," ","d"," ","q"}]}],")"}]," ",SuperscriptBox["\[Eta]","5"]}],"+",RowBox[
{FractionBox["4","35"]," ",SuperscriptBox["a","2"]," ",SuperscriptBox["d","2"]," ",RowBox[
{"(",RowBox[{RowBox[{SuperscriptBox["b","2"]," ","d"}],"+",RowBox[{"4"," ","a"," ","b"," ","d"," ","p"}],"+",RowBox[
{"a"," ",RowBox[{"(",RowBox[{SuperscriptBox["e","2"],"+",RowBox[{"4"," ","d"," ","e"," ","q"}],"+",RowBox[
{"4"," ","d"," ",RowBox[{"(",RowBox[{RowBox[{"a"," ",SuperscriptBox["p","2"]}],"+",RowBox[
{"d"," ",SuperscriptBox["q","2"]}]}],")"}]}]}],")"}]}]}],")"}]," ",SuperscriptBox[
"\[Eta]","6"]}],"-",RowBox[{FractionBox["8","35"]," ",SuperscriptBox["a","3"]," ",SuperscriptBox[
"d","3"]," ",RowBox[{"(",RowBox[{"b","+",RowBox[{"2"," ","a"," ","p"}]}],")"}]," ",RowBox[
{"(",RowBox[{"e","+",RowBox[{"2"," ","d"," ","q"}]}],")"}]," ",SuperscriptBox["\[Eta]",
"7"]}],"+",RowBox[{FractionBox["32","315"]," ",SuperscriptBox["a","3"]," ",SuperscriptBox[
"d","3"]," ",RowBox[{"(",RowBox[{RowBox[{SuperscriptBox["b","2"]," ","d"}],"+",RowBox[
{"4"," ","a"," ","b"," ","d"," ","p"}],"+",RowBox[{"a"," ",RowBox[{"(",RowBox[{SuperscriptBox[
"e","2"],"+",RowBox[{"4"," ","d"," ","e"," ","q"}],"+",RowBox[{"4"," ","d"," ",RowBox[
{"(",RowBox[{RowBox[{"a"," ",SuperscriptBox["p","2"]}],"+",RowBox[{"d"," ",SuperscriptBox[
"q","2"]}]}],")"}]}]}],")"}]}]}],")"}]," ",SuperscriptBox["\[Eta]","8"]}]}],StandardForm],
"Output",CellLabel -> "Out[84]= ",ExpressionUUID -> "fdade4ff-5e82-4ed8-9bac-87ac192ba268"]},
Open],ExpressionUUID -> "e77bf513-1226-493c-bfb0-b4e2df1415de"],Cell[
CellGroupData[
{Cell[
BoxData[RowBox[{"NthHamiltonian","[",RowBox[{"f2",",","g2",",","p",",","q",",","\[Eta]",",","5"}],"]"}]],
"Input",CellLabel -> "In[85]:= ",ExpressionUUID -> "6ab1f285-d466-42b3-b1e8-65eb661e7b13"],Cell[
BoxData[
RowBox[{RowBox[{"-",FractionBox[RowBox[{RowBox[{"(",RowBox[{RowBox[{"a"," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{"a"," ","p"}]]}],"+",RowBox[{"b"," ",SuperscriptBox["\[ExponentialE]",
RowBox[{"b"," ","p"}]]}]}],")"}]," ",RowBox[{"(",RowBox[{RowBox[{"a"," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{"a"," ","q"}]]}],"+",RowBox[{"b"," ",SuperscriptBox["\[ExponentialE]",
RowBox[{"b"," ","q"}]]}]}],")"}]," ","\[Eta]"}],RowBox[{"2"," ",RowBox[{"(",RowBox[
{SuperscriptBox["\[ExponentialE]",RowBox[{"a"," ","p"}]],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{"b"," ","p"}]]}],")"}]," ",RowBox[{"(",RowBox[{SuperscriptBox["\[ExponentialE]",
RowBox[{"a"," ","q"}]],"+",SuperscriptBox["\[ExponentialE]",RowBox[{"b"," ","q"}]]}],")"}]}]]}],"+",FractionBox[
RowBox[{SuperscriptBox[RowBox[{"(",RowBox[{"a","-","b"}],")"}],"2"]," ",RowBox[{"(",RowBox[
{RowBox[{"4"," ","a"," ","b"," ",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[
{"(",RowBox[{"a","+","b"}],")"}]," ",RowBox[{"(",RowBox[{"p","+","q"}],")"}]}]]}],"+",RowBox[
{SuperscriptBox["b","2"]," ",SuperscriptBox["\[ExponentialE]",RowBox[{"b"," ",RowBox[
{"(",RowBox[{"p","+","q"}],")"}]}]]," ",RowBox[{"(",RowBox[{SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"b"," ","p"}],"+",RowBox[{"a"," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[{"b"," ","q"}]}]]}],")"}]}],"+",RowBox[{SuperscriptBox[
"a","2"]," ",RowBox[{"(",RowBox[{SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[
{"a"," ","p"}],"+",RowBox[{"b"," ","p"}],"+",RowBox[{"2"," ","a"," ","q"}]}]],"+",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"2"," ","a"," ","p"}],"+",RowBox[{"a"," ","q"}],"+",RowBox[
{"b"," ","q"}]}]]}],")"}]}]}],")"}]," ",SuperscriptBox["\[Eta]","2"]}],RowBox[{"12"," ",SuperscriptBox[
RowBox[{"(",RowBox[{SuperscriptBox["\[ExponentialE]",RowBox[{"a"," ","p"}]],"+",SuperscriptBox[
"\[ExponentialE]",RowBox[{"b"," ","p"}]]}],")"}],"2"]," ",SuperscriptBox[RowBox[{"(",RowBox[
{SuperscriptBox["\[ExponentialE]",RowBox[{"a"," ","q"}]],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{"b"," ","q"}]]}],")"}],"2"]}]],"-",FractionBox[RowBox[{SuperscriptBox[RowBox[
{"(",RowBox[{"a","-","b"}],")"}],"4"]," ",SuperscriptBox["\[ExponentialE]",RowBox[
{RowBox[{"(",RowBox[{"a","+","b"}],")"}]," ",RowBox[{"(",RowBox[{"p","+","q"}],")"}]}]]," ",RowBox[
{"(",RowBox[{RowBox[{"a"," ",SuperscriptBox["\[ExponentialE]",RowBox[{"a"," ","p"}]]}],"+",RowBox[
{"b"," ",SuperscriptBox["\[ExponentialE]",RowBox[{"b"," ","p"}]]}]}],")"}]," ",RowBox[
{"(",RowBox[{RowBox[{"a"," ",SuperscriptBox["\[ExponentialE]",RowBox[{"a"," ","q"}]]}],"+",RowBox[
{"b"," ",SuperscriptBox["\[ExponentialE]",RowBox[{"b"," ","q"}]]}]}],")"}]," ",SuperscriptBox[
"\[Eta]","3"]}],RowBox[{"12"," ",SuperscriptBox[RowBox[{"(",RowBox[{SuperscriptBox[
"\[ExponentialE]",RowBox[{"a"," ","p"}]],"+",SuperscriptBox["\[ExponentialE]",RowBox[
{"b"," ","p"}]]}],")"}],"3"]," ",SuperscriptBox[RowBox[{"(",RowBox[{SuperscriptBox[
"\[ExponentialE]",RowBox[{"a"," ","q"}]],"+",SuperscriptBox["\[ExponentialE]",RowBox[
{"b"," ","q"}]]}],")"}],"3"]}]],"-",FractionBox[RowBox[{SuperscriptBox[RowBox[{"(",RowBox[
{"a","-","b"}],")"}],"4"]," ",RowBox[{"(",RowBox[{RowBox[{RowBox[{"-","2"}]," ",SuperscriptBox[
"a","3"]," ","b"," ",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"(",RowBox[
{"a","+","b"}],")"}]," ",RowBox[{"(",RowBox[{"p","+","q"}],")"}]}]]," ",RowBox[{"(",RowBox[
{RowBox[{"2"," ",SuperscriptBox["\[ExponentialE]",RowBox[{"2"," ","a"," ",RowBox[
{"(",RowBox[{"p","+","q"}],")"}]}]]}],"+",RowBox[{"36"," ",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"(",RowBox[{"a","+","b"}],")"}]," ",RowBox[{"(",RowBox[{"p","+","q"}],")"}]}]]}],"-",RowBox[
{"16"," ",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[
{"b"," ","p"}],"+",RowBox[{"2"," ","a"," ","q"}]}]]}],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"2"," ","b"," ","p"}],"+",RowBox[{"2"," ","a"," ","q"}]}]],"-",RowBox[
{"16"," ",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"2"," ","a"," ","p"}],"+",RowBox[
{"a"," ","q"}],"+",RowBox[{"b"," ","q"}]}]]}],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"2"," ","a"," ","p"}],"+",RowBox[{"2"," ","b"," ","q"}]}]]}],")"}]}],"-",RowBox[
{"2"," ","a"," ",SuperscriptBox["b","3"]," ",SuperscriptBox["\[ExponentialE]",RowBox[
{RowBox[{"(",RowBox[{"a","+","b"}],")"}]," ",RowBox[{"(",RowBox[{"p","+","q"}],")"}]}]]," ",RowBox[
{"(",RowBox[{RowBox[{"2"," ",SuperscriptBox["\[ExponentialE]",RowBox[{"2"," ","b"," ",RowBox[
{"(",RowBox[{"p","+","q"}],")"}]}]]}],"+",RowBox[{"36"," ",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"(",RowBox[{"a","+","b"}],")"}]," ",RowBox[{"(",RowBox[{"p","+","q"}],")"}]}]]}],"+",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"2"," ","b"," ","p"}],"+",RowBox[{"2"," ","a"," ","q"}]}]],"-",RowBox[
{"16"," ",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"2"," ","b"," ","p"}],"+",RowBox[
{"a"," ","q"}],"+",RowBox[{"b"," ","q"}]}]]}],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"2"," ","a"," ","p"}],"+",RowBox[{"2"," ","b"," ","q"}]}]],"-",RowBox[
{"16"," ",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[
{"b"," ","p"}],"+",RowBox[{"2"," ","b"," ","q"}]}]]}]}],")"}]}],"+",RowBox[{"12"," ",SuperscriptBox[
"a","2"]," ",SuperscriptBox["b","2"]," ",SuperscriptBox["\[ExponentialE]",RowBox[
{RowBox[{"(",RowBox[{"a","+","b"}],")"}]," ",RowBox[{"(",RowBox[{"p","+","q"}],")"}]}]]," ",RowBox[
{"(",RowBox[{RowBox[{"8"," ",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"(",RowBox[
{"a","+","b"}],")"}]," ",RowBox[{"(",RowBox[{"p","+","q"}],")"}]}]]}],"-",RowBox[
{"2"," ",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[
{"b"," ","p"}],"+",RowBox[{"2"," ","a"," ","q"}]}]]}],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"2"," ","b"," ","p"}],"+",RowBox[{"2"," ","a"," ","q"}]}]],"-",RowBox[
{"2"," ",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"2"," ","a"," ","p"}],"+",RowBox[
{"a"," ","q"}],"+",RowBox[{"b"," ","q"}]}]]}],"-",RowBox[{"2"," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"2"," ","b"," ","p"}],"+",RowBox[{"a"," ","q"}],"+",RowBox[
{"b"," ","q"}]}]]}],"+",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"2"," ","a"," ","p"}],"+",RowBox[
{"2"," ","b"," ","q"}]}]],"-",RowBox[{"2"," ",SuperscriptBox["\[ExponentialE]",RowBox[
{RowBox[{"a"," ","p"}],"+",RowBox[{"b"," ","p"}],"+",RowBox[{"2"," ","b"," ","q"}]}]]}]}],")"}]}],"+",RowBox[
{SuperscriptBox["a","4"]," ",RowBox[{"(",RowBox[{RowBox[{"12"," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"(",RowBox[{RowBox[{"3"," ","a"}],"+","b"}],")"}]," ",RowBox[
{"(",RowBox[{"p","+","q"}],")"}]}]]}],"+",SuperscriptBox["\[ExponentialE]",RowBox[
{RowBox[{"3"," ","a"," ","p"}],"+",RowBox[{"b"," ","p"}],"+",RowBox[{"4"," ","a"," ","q"}]}]],"-",RowBox[
{"4"," ",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"2"," ","a"," ","p"}],"+",RowBox[
{"2"," ","b"," ","p"}],"+",RowBox[{"4"," ","a"," ","q"}]}]]}],"+",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[{"3"," ","b"," ","p"}],"+",RowBox[
{"4"," ","a"," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"4"," ","a"," ","p"}],"+",RowBox[
{"3"," ","a"," ","q"}],"+",RowBox[{"b"," ","q"}]}]],"-",RowBox[{"18"," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"2"," ","a"," ","p"}],"+",RowBox[{"2"," ","b"," ","p"}],"+",RowBox[
{"3"," ","a"," ","q"}],"+",RowBox[{"b"," ","q"}]}]]}],"-",RowBox[{"4"," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"4"," ","a"," ","p"}],"+",RowBox[{"2"," ","a"," ","q"}],"+",RowBox[
{"2"," ","b"," ","q"}]}]]}],"-",RowBox[{"18"," ",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"3"," ","a"," ","p"}],"+",RowBox[{"b"," ","p"}],"+",RowBox[{"2"," ","a"," ","q"}],"+",RowBox[
{"2"," ","b"," ","q"}]}]]}],"+",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"4"," ","a"," ","p"}],"+",RowBox[
{"a"," ","q"}],"+",RowBox[{"3"," ","b"," ","q"}]}]]}],")"}]}],"+",RowBox[{SuperscriptBox[
"b","4"]," ",RowBox[{"(",RowBox[{RowBox[{"12"," ",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"(",RowBox[{"a","+",RowBox[{"3"," ","b"}]}],")"}]," ",RowBox[{"(",RowBox[
{"p","+","q"}],")"}]}]]}],"+",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"4"," ","b"," ","p"}],"+",RowBox[
{"3"," ","a"," ","q"}],"+",RowBox[{"b"," ","q"}]}]],"-",RowBox[{"18"," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[{"3"," ","b"," ","p"}],"+",RowBox[
{"2"," ","a"," ","q"}],"+",RowBox[{"2"," ","b"," ","q"}]}]]}],"-",RowBox[{"4"," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"4"," ","b"," ","p"}],"+",RowBox[{"2"," ","a"," ","q"}],"+",RowBox[
{"2"," ","b"," ","q"}]}]]}],"-",RowBox[{"18"," ",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"2"," ","a"," ","p"}],"+",RowBox[{"2"," ","b"," ","p"}],"+",RowBox[
{"a"," ","q"}],"+",RowBox[{"3"," ","b"," ","q"}]}]]}],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"4"," ","b"," ","p"}],"+",RowBox[{"a"," ","q"}],"+",RowBox[{"3"," ","b"," ","q"}]}]],"+",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"3"," ","a"," ","p"}],"+",RowBox[{"b"," ","p"}],"+",RowBox[
{"4"," ","b"," ","q"}]}]],"-",RowBox[{"4"," ",SuperscriptBox["\[ExponentialE]",RowBox[
{RowBox[{"2"," ","a"," ","p"}],"+",RowBox[{"2"," ","b"," ","p"}],"+",RowBox[{"4"," ","b"," ","q"}]}]]}],"+",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[{"3"," ","b"," ","p"}],"+",RowBox[
{"4"," ","b"," ","q"}]}]]}],")"}]}]}],")"}]," ",SuperscriptBox["\[Eta]","4"]}],RowBox[
{"720"," ",SuperscriptBox[RowBox[{"(",RowBox[{SuperscriptBox["\[ExponentialE]",RowBox[
{"a"," ","p"}]],"+",SuperscriptBox["\[ExponentialE]",RowBox[{"b"," ","p"}]]}],")"}],
"4"]," ",SuperscriptBox[RowBox[{"(",RowBox[{SuperscriptBox["\[ExponentialE]",RowBox[
{"a"," ","q"}]],"+",SuperscriptBox["\[ExponentialE]",RowBox[{"b"," ","q"}]]}],")"}],
"4"]}]],"+",FractionBox[RowBox[{SuperscriptBox[RowBox[{"(",RowBox[{"a","-","b"}],")"}],
"6"]," ",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"(",RowBox[{"a","+","b"}],")"}]," ",RowBox[
{"(",RowBox[{"p","+","q"}],")"}]}]]," ",RowBox[{"(",RowBox[{RowBox[{"a"," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{"a"," ","p"}]]}],"+",RowBox[{"b"," ",SuperscriptBox["\[ExponentialE]",
RowBox[{"b"," ","p"}]]}]}],")"}]," ",RowBox[{"(",RowBox[{RowBox[{"a"," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{"a"," ","q"}]]}],"+",RowBox[{"b"," ",SuperscriptBox["\[ExponentialE]",
RowBox[{"b"," ","q"}]]}]}],")"}]," ",RowBox[{"(",RowBox[{RowBox[{SuperscriptBox["a",
"2"]," ",RowBox[{"(",RowBox[{SuperscriptBox["\[ExponentialE]",RowBox[{"2"," ","a"," ",RowBox[
{"(",RowBox[{"p","+","q"}],")"}]}]],"-",RowBox[{"27"," ",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"(",RowBox[{"a","+","b"}],")"}]," ",RowBox[{"(",RowBox[{"p","+","q"}],")"}]}]]}],"+",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[{"b"," ","p"}],"+",RowBox[
{"2"," ","a"," ","q"}]}]],"+",RowBox[{"2"," ",SuperscriptBox["\[ExponentialE]",RowBox[
{RowBox[{"2"," ","b"," ","p"}],"+",RowBox[{"2"," ","a"," ","q"}]}]]}],"+",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"2"," ","a"," ","p"}],"+",RowBox[{"a"," ","q"}],"+",RowBox[
{"b"," ","q"}]}]],"+",RowBox[{"2"," ",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[
{"2"," ","a"," ","p"}],"+",RowBox[{"2"," ","b"," ","q"}]}]]}]}],")"}]}],"+",RowBox[
{"a"," ","b"," ",RowBox[{"(",RowBox[{RowBox[{"22"," ",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"(",RowBox[{"a","+","b"}],")"}]," ",RowBox[{"(",RowBox[{"p","+","q"}],")"}]}]]}],"-",RowBox[
{"5"," ",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[
{"b"," ","p"}],"+",RowBox[{"2"," ","a"," ","q"}]}]]}],"+",RowBox[{"3"," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"2"," ","b"," ","p"}],"+",RowBox[{"2"," ","a"," ","q"}]}]]}],"-",RowBox[
{"5"," ",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"2"," ","a"," ","p"}],"+",RowBox[
{"a"," ","q"}],"+",RowBox[{"b"," ","q"}]}]]}],"-",RowBox[{"5"," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"2"," ","b"," ","p"}],"+",RowBox[{"a"," ","q"}],"+",RowBox[
{"b"," ","q"}]}]]}],"+",RowBox[{"3"," ",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[
{"2"," ","a"," ","p"}],"+",RowBox[{"2"," ","b"," ","q"}]}]]}],"-",RowBox[{"5"," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[{"b"," ","p"}],"+",RowBox[
{"2"," ","b"," ","q"}]}]]}]}],")"}]}],"+",RowBox[{SuperscriptBox["b","2"]," ",RowBox[
{"(",RowBox[{SuperscriptBox["\[ExponentialE]",RowBox[{"2"," ","b"," ",RowBox[{"(",RowBox[
{"p","+","q"}],")"}]}]],"-",RowBox[{"27"," ",SuperscriptBox["\[ExponentialE]",RowBox[
{RowBox[{"(",RowBox[{"a","+","b"}],")"}]," ",RowBox[{"(",RowBox[{"p","+","q"}],")"}]}]]}],"+",RowBox[
{"2"," ",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"2"," ","b"," ","p"}],"+",RowBox[
{"2"," ","a"," ","q"}]}]]}],"+",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"2"," ","b"," ","p"}],"+",RowBox[
{"a"," ","q"}],"+",RowBox[{"b"," ","q"}]}]],"+",RowBox[{"2"," ",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"2"," ","a"," ","p"}],"+",RowBox[{"2"," ","b"," ","q"}]}]]}],"+",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[{"b"," ","p"}],"+",RowBox[
{"2"," ","b"," ","q"}]}]]}],")"}]}]}],")"}]," ",SuperscriptBox["\[Eta]","5"]}],RowBox[
{"720"," ",SuperscriptBox[RowBox[{"(",RowBox[{SuperscriptBox["\[ExponentialE]",RowBox[
{"a"," ","p"}]],"+",SuperscriptBox["\[ExponentialE]",RowBox[{"b"," ","p"}]]}],")"}],
"5"]," ",SuperscriptBox[RowBox[{"(",RowBox[{SuperscriptBox["\[ExponentialE]",RowBox[
{"a"," ","q"}]],"+",SuperscriptBox["\[ExponentialE]",RowBox[{"b"," ","q"}]]}],")"}],
"5"]}]],"+",RowBox[{"Log","[",RowBox[{SuperscriptBox["\[ExponentialE]",RowBox[{"a"," ","p"}]],"+",SuperscriptBox[
"\[ExponentialE]",RowBox[{"b"," ","p"}]]}],"]"}],"+",RowBox[{"Log","[",RowBox[{SuperscriptBox[
"\[ExponentialE]",RowBox[{"a"," ","q"}]],"+",SuperscriptBox["\[ExponentialE]",RowBox[
{"b"," ","q"}]]}],"]"}]}],StandardForm],"Output",CellLabel -> "Out[85]= ",ExpressionUUID -> "d5c9a99f-3b94-4632-b7fc-d1118a403ccf"]},
Open],ExpressionUUID -> "12381a1b-4739-429f-96f0-118e57aacb74"],Cell[
CellGroupData[
{Cell[
BoxData[RowBox[{"NthHamiltonian","[",RowBox[{"f3",",","g3",",","p",",","q",",","\[Eta]",",","3"}],"]"}]],
"Input",CellLabel -> "In[86]:= ",ExpressionUUID -> "e1dadacf-62b0-470c-885c-b6a407f2c72f"],Cell[
BoxData[
RowBox[{RowBox[{"-",FractionBox[RowBox[{RowBox[{"(",RowBox[{RowBox[{"a"," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{"a"," ","p"}]]}],"+",RowBox[{"b"," ",SuperscriptBox["\[ExponentialE]",
RowBox[{"b"," ","p"}]]}],"+",RowBox[{"c"," ",SuperscriptBox["\[ExponentialE]",RowBox[
{"c"," ","p"}]]}]}],")"}]," ",RowBox[{"(",RowBox[{RowBox[{"a"," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{"a"," ","q"}]]}],"+",RowBox[{"b"," ",SuperscriptBox["\[ExponentialE]",
RowBox[{"b"," ","q"}]]}],"+",RowBox[{"c"," ",SuperscriptBox["\[ExponentialE]",RowBox[
{"c"," ","q"}]]}]}],")"}]," ","\[Eta]"}],RowBox[{"2"," ",RowBox[{"(",RowBox[{SuperscriptBox[
"\[ExponentialE]",RowBox[{"a"," ","p"}]],"+",SuperscriptBox["\[ExponentialE]",RowBox[
{"b"," ","p"}]],"+",SuperscriptBox["\[ExponentialE]",RowBox[{"c"," ","p"}]]}],")"}]," ",RowBox[
{"(",RowBox[{SuperscriptBox["\[ExponentialE]",RowBox[{"a"," ","q"}]],"+",SuperscriptBox[
"\[ExponentialE]",RowBox[{"b"," ","q"}]],"+",SuperscriptBox["\[ExponentialE]",RowBox[
{"c"," ","q"}]]}],")"}]}]]}],"+",FractionBox[RowBox[{RowBox[{"(",RowBox[{RowBox[{SuperscriptBox[
"a","4"]," ",SuperscriptBox["\[ExponentialE]",RowBox[{"a"," ",RowBox[{"(",RowBox[
{"p","+","q"}],")"}]}]]," ",RowBox[{"(",RowBox[{SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"b"," ","p"}],"+",RowBox[{"a"," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"c"," ","p"}],"+",RowBox[{"a"," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[{"b"," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[{"c"," ","q"}]}]]}],")"}]}],"+",RowBox[{"2"," ","b"," ",SuperscriptBox[
"c","3"]," ",SuperscriptBox["\[ExponentialE]",RowBox[{"c"," ",RowBox[{"(",RowBox[
{"p","+","q"}],")"}]}]]," ",RowBox[{"(",RowBox[{RowBox[{"2"," ",SuperscriptBox["\[ExponentialE]",
RowBox[{"b"," ",RowBox[{"(",RowBox[{"p","+","q"}],")"}]}]]}],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"b"," ","p"}],"+",RowBox[{"a"," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[{"b"," ","q"}]}]],"-",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"c"," ","p"}],"+",RowBox[{"b"," ","q"}]}]],"-",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"b"," ","p"}],"+",RowBox[{"c"," ","q"}]}]]}],")"}]}],"+",RowBox[{"2"," ",SuperscriptBox[
"b","3"]," ","c"," ",SuperscriptBox["\[ExponentialE]",RowBox[{"b"," ",RowBox[{"(",RowBox[
{"p","+","q"}],")"}]}]]," ",RowBox[{"(",RowBox[{RowBox[{"2"," ",SuperscriptBox["\[ExponentialE]",
RowBox[{"c"," ",RowBox[{"(",RowBox[{"p","+","q"}],")"}]}]]}],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"c"," ","p"}],"+",RowBox[{"a"," ","q"}]}]],"-",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"c"," ","p"}],"+",RowBox[{"b"," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[{"c"," ","q"}]}]],"-",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"b"," ","p"}],"+",RowBox[{"c"," ","q"}]}]]}],")"}]}],"+",RowBox[{SuperscriptBox[
"b","4"]," ",SuperscriptBox["\[ExponentialE]",RowBox[{"b"," ",RowBox[{"(",RowBox[
{"p","+","q"}],")"}]}]]," ",RowBox[{"(",RowBox[{SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"b"," ","p"}],"+",RowBox[{"a"," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[{"b"," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"c"," ","p"}],"+",RowBox[{"b"," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"b"," ","p"}],"+",RowBox[{"c"," ","q"}]}]]}],")"}]}],"+",RowBox[{SuperscriptBox[
"c","4"]," ",SuperscriptBox["\[ExponentialE]",RowBox[{"c"," ",RowBox[{"(",RowBox[
{"p","+","q"}],")"}]}]]," ",RowBox[{"(",RowBox[{SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"c"," ","p"}],"+",RowBox[{"a"," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"c"," ","p"}],"+",RowBox[{"b"," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[{"c"," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"b"," ","p"}],"+",RowBox[{"c"," ","q"}]}]]}],")"}]}],"+",RowBox[{SuperscriptBox[
"b","2"]," ",SuperscriptBox["c","2"]," ",RowBox[{"(",RowBox[{RowBox[{RowBox[{"-","8"}]," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"(",RowBox[{"b","+","c"}],")"}]," ",RowBox[{"(",RowBox[
{"p","+","q"}],")"}]}]]}],"+",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[
{"c"," ","p"}],"+",RowBox[{"2"," ","b"," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"b"," ","p"}],"+",RowBox[{"c"," ","p"}],"+",RowBox[{"2"," ","b"," ","q"}]}]],"+",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"2"," ","c"," ","p"}],"+",RowBox[{RowBox[{"(",RowBox[
{"a","+","b"}],")"}]," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[
{"2"," ","b"," ","p"}],"+",RowBox[{"b"," ","q"}],"+",RowBox[{"c"," ","q"}]}]],"+",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"2"," ","c"," ","p"}],"+",RowBox[{"b"," ","q"}],"+",RowBox[
{"c"," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[
{"b"," ","p"}],"+",RowBox[{"2"," ","c"," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"b"," ","p"}],"+",RowBox[{"c"," ","p"}],"+",RowBox[{"2"," ","c"," ","q"}]}]],"+",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"2"," ","b"," ","p"}],"+",RowBox[{RowBox[{"(",RowBox[
{"a","+","c"}],")"}]," ","q"}]}]]}],")"}]}],"+",RowBox[{"2"," ",SuperscriptBox["a",
"3"]," ",SuperscriptBox["\[ExponentialE]",RowBox[{"a"," ",RowBox[{"(",RowBox[{"p","+","q"}],")"}]}]]," ",RowBox[
{"(",RowBox[{RowBox[{"b"," ",RowBox[{"(",RowBox[{RowBox[{"2"," ",SuperscriptBox["\[ExponentialE]",
RowBox[{"b"," ",RowBox[{"(",RowBox[{"p","+","q"}],")"}]}]]}],"-",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"b"," ","p"}],"+",RowBox[{"a"," ","q"}]}]],"-",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[{"b"," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"c"," ","p"}],"+",RowBox[{"b"," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"b"," ","p"}],"+",RowBox[{"c"," ","q"}]}]]}],")"}]}],"+",RowBox[{"c"," ",RowBox[
{"(",RowBox[{RowBox[{"2"," ",SuperscriptBox["\[ExponentialE]",RowBox[{"c"," ",RowBox[
{"(",RowBox[{"p","+","q"}],")"}]}]]}],"-",SuperscriptBox["\[ExponentialE]",RowBox[
{RowBox[{"c"," ","p"}],"+",RowBox[{"a"," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"c"," ","p"}],"+",RowBox[{"b"," ","q"}]}]],"-",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[{"c"," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"b"," ","p"}],"+",RowBox[{"c"," ","q"}]}]]}],")"}]}]}],")"}]}],"+",RowBox[
{SuperscriptBox["a","2"]," ",RowBox[{"(",RowBox[{RowBox[{SuperscriptBox["c","2"]," ",RowBox[
{"(",RowBox[{RowBox[{RowBox[{"-","8"}]," ",SuperscriptBox["\[ExponentialE]",RowBox[
{RowBox[{"(",RowBox[{"a","+","c"}],")"}]," ",RowBox[{"(",RowBox[{"p","+","q"}],")"}]}]]}],"+",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[{"c"," ","p"}],"+",RowBox[
{"2"," ","a"," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"b"," ","p"}],"+",RowBox[
{"c"," ","p"}],"+",RowBox[{"2"," ","a"," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"2"," ","c"," ","p"}],"+",RowBox[{RowBox[{"(",RowBox[{"a","+","b"}],")"}]," ","q"}]}]],"+",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"2"," ","a"," ","p"}],"+",RowBox[{"a"," ","q"}],"+",RowBox[
{"c"," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"2"," ","c"," ","p"}],"+",RowBox[
{"a"," ","q"}],"+",RowBox[{"c"," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[{"b"," ","p"}],"+",RowBox[{"2"," ","c"," ","q"}]}]],"+",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[{"c"," ","p"}],"+",RowBox[
{"2"," ","c"," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"2"," ","a"," ","p"}],"+",RowBox[
{RowBox[{"(",RowBox[{"b","+","c"}],")"}]," ","q"}]}]]}],")"}]}],"+",RowBox[{SuperscriptBox[
"b","2"]," ",RowBox[{"(",RowBox[{RowBox[{RowBox[{"-","8"}]," ",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"(",RowBox[{"a","+","b"}],")"}]," ",RowBox[{"(",RowBox[{"p","+","q"}],")"}]}]]}],"+",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[{"b"," ","p"}],"+",RowBox[
{"2"," ","a"," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"b"," ","p"}],"+",RowBox[
{"c"," ","p"}],"+",RowBox[{"2"," ","a"," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"2"," ","a"," ","p"}],"+",RowBox[{"a"," ","q"}],"+",RowBox[{"b"," ","q"}]}]],"+",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"2"," ","b"," ","p"}],"+",RowBox[{"a"," ","q"}],"+",RowBox[
{"b"," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[
{"b"," ","p"}],"+",RowBox[{"2"," ","b"," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[{"c"," ","p"}],"+",RowBox[{"2"," ","b"," ","q"}]}]],"+",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"2"," ","b"," ","p"}],"+",RowBox[{RowBox[{"(",RowBox[
{"a","+","c"}],")"}]," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[
{"2"," ","a"," ","p"}],"+",RowBox[{RowBox[{"(",RowBox[{"b","+","c"}],")"}]," ","q"}]}]]}],")"}]}],"-",RowBox[
{"2"," ","b"," ","c"," ",RowBox[{"(",RowBox[{SuperscriptBox["\[ExponentialE]",RowBox[
{RowBox[{"b"," ","p"}],"+",RowBox[{"c"," ","p"}],"+",RowBox[{"2"," ","a"," ","q"}]}]],"+",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"2"," ","a"," ","p"}],"+",RowBox[{RowBox[{"(",RowBox[
{"b","+","c"}],")"}]," ","q"}]}]],"+",RowBox[{"4"," ",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"c"," ","p"}],"+",RowBox[{"b"," ","q"}],"+",RowBox[{"a"," ",RowBox[
{"(",RowBox[{"p","+","q"}],")"}]}]}]]}],"+",RowBox[{"4"," ",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"b"," ","p"}],"+",RowBox[{"c"," ","q"}],"+",RowBox[{"a"," ",RowBox[
{"(",RowBox[{"p","+","q"}],")"}]}]}]]}],"-",SuperscriptBox["\[ExponentialE]",RowBox[
{RowBox[{"c"," ","p"}],"+",RowBox[{"a"," ","q"}],"+",RowBox[{"b"," ",RowBox[{"(",RowBox[
{"p","+","q"}],")"}]}]}]],"-",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[
{"c"," ","q"}],"+",RowBox[{"b"," ",RowBox[{"(",RowBox[{"p","+","q"}],")"}]}]}]],"-",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"b"," ","p"}],"+",RowBox[{"a"," ","q"}],"+",RowBox[
{"c"," ",RowBox[{"(",RowBox[{"p","+","q"}],")"}]}]}]],"-",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[{"b"," ","q"}],"+",RowBox[{"c"," ",RowBox[
{"(",RowBox[{"p","+","q"}],")"}]}]}]]}],")"}]}]}],")"}]}],"-",RowBox[{"2"," ","a"," ",RowBox[
{"(",RowBox[{RowBox[{SuperscriptBox["b","3"]," ",SuperscriptBox["\[ExponentialE]",
RowBox[{"b"," ",RowBox[{"(",RowBox[{"p","+","q"}],")"}]}]]," ",RowBox[{"(",RowBox[
{RowBox[{RowBox[{"-","2"}]," ",SuperscriptBox["\[ExponentialE]",RowBox[{"a"," ",RowBox[
{"(",RowBox[{"p","+","q"}],")"}]}]]}],"+",SuperscriptBox["\[ExponentialE]",RowBox[
{RowBox[{"b"," ","p"}],"+",RowBox[{"a"," ","q"}]}]],"-",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"c"," ","p"}],"+",RowBox[{"a"," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[{"b"," ","q"}]}]],"-",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[{"c"," ","q"}]}]]}],")"}]}],"-",RowBox[{SuperscriptBox[
"c","3"]," ",SuperscriptBox["\[ExponentialE]",RowBox[{"c"," ",RowBox[{"(",RowBox[
{"p","+","q"}],")"}]}]]," ",RowBox[{"(",RowBox[{RowBox[{"2"," ",SuperscriptBox["\[ExponentialE]",
RowBox[{"a"," ",RowBox[{"(",RowBox[{"p","+","q"}],")"}]}]]}],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"b"," ","p"}],"+",RowBox[{"a"," ","q"}]}]],"-",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"c"," ","p"}],"+",RowBox[{"a"," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[{"b"," ","q"}]}]],"-",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[{"c"," ","q"}]}]]}],")"}]}],"+",RowBox[{SuperscriptBox[
"b","2"]," ","c"," ",RowBox[{"(",RowBox[{SuperscriptBox["\[ExponentialE]",RowBox[
{RowBox[{"a"," ","p"}],"+",RowBox[{"c"," ","p"}],"+",RowBox[{"2"," ","b"," ","q"}]}]],"+",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"2"," ","b"," ","p"}],"+",RowBox[{RowBox[{"(",RowBox[
{"a","+","c"}],")"}]," ","q"}]}]],"-",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[
{"c"," ","p"}],"+",RowBox[{"b"," ","q"}],"+",RowBox[{"a"," ",RowBox[{"(",RowBox[{"p","+","q"}],")"}]}]}]],"-",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"b"," ","p"}],"+",RowBox[{"c"," ","q"}],"+",RowBox[
{"a"," ",RowBox[{"(",RowBox[{"p","+","q"}],")"}]}]}]],"+",RowBox[{"4"," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"c"," ","p"}],"+",RowBox[{"a"," ","q"}],"+",RowBox[
{"b"," ",RowBox[{"(",RowBox[{"p","+","q"}],")"}]}]}]]}],"+",RowBox[{"4"," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[{"c"," ","q"}],"+",RowBox[
{"b"," ",RowBox[{"(",RowBox[{"p","+","q"}],")"}]}]}]]}],"-",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"b"," ","p"}],"+",RowBox[{"a"," ","q"}],"+",RowBox[{"c"," ",RowBox[
{"(",RowBox[{"p","+","q"}],")"}]}]}]],"-",SuperscriptBox["\[ExponentialE]",RowBox[
{RowBox[{"a"," ","p"}],"+",RowBox[{"b"," ","q"}],"+",RowBox[{"c"," ",RowBox[{"(",RowBox[
{"p","+","q"}],")"}]}]}]]}],")"}]}],"+",RowBox[{"b"," ",SuperscriptBox["c","2"]," ",RowBox[
{"(",RowBox[{SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"2"," ","c"," ","p"}],"+",RowBox[
{RowBox[{"(",RowBox[{"a","+","b"}],")"}]," ","q"}]}]],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[{"b"," ","p"}],"+",RowBox[{"2"," ","c"," ","q"}]}]],"-",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"c"," ","p"}],"+",RowBox[{"b"," ","q"}],"+",RowBox[
{"a"," ",RowBox[{"(",RowBox[{"p","+","q"}],")"}]}]}]],"-",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"b"," ","p"}],"+",RowBox[{"c"," ","q"}],"+",RowBox[{"a"," ",RowBox[
{"(",RowBox[{"p","+","q"}],")"}]}]}]],"-",SuperscriptBox["\[ExponentialE]",RowBox[
{RowBox[{"c"," ","p"}],"+",RowBox[{"a"," ","q"}],"+",RowBox[{"b"," ",RowBox[{"(",RowBox[
{"p","+","q"}],")"}]}]}]],"-",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[
{"c"," ","q"}],"+",RowBox[{"b"," ",RowBox[{"(",RowBox[{"p","+","q"}],")"}]}]}]],"+",RowBox[
{"4"," ",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"b"," ","p"}],"+",RowBox[
{"a"," ","q"}],"+",RowBox[{"c"," ",RowBox[{"(",RowBox[{"p","+","q"}],")"}]}]}]]}],"+",RowBox[
{"4"," ",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"a"," ","p"}],"+",RowBox[
{"b"," ","q"}],"+",RowBox[{"c"," ",RowBox[{"(",RowBox[{"p","+","q"}],")"}]}]}]]}]}],")"}]}]}],")"}]}]}],")"}]," ",SuperscriptBox[
"\[Eta]","2"]}],RowBox[{"12"," ",SuperscriptBox[RowBox[{"(",RowBox[{SuperscriptBox[
"\[ExponentialE]",RowBox[{"a"," ","p"}]],"+",SuperscriptBox["\[ExponentialE]",RowBox[
{"b"," ","p"}]],"+",SuperscriptBox["\[ExponentialE]",RowBox[{"c"," ","p"}]]}],")"}],
"2"]," ",SuperscriptBox[RowBox[{"(",RowBox[{SuperscriptBox["\[ExponentialE]",RowBox[
{"a"," ","q"}]],"+",SuperscriptBox["\[ExponentialE]",RowBox[{"b"," ","q"}]],"+",SuperscriptBox[
"\[ExponentialE]",RowBox[{"c"," ","q"}]]}],")"}],"2"]}]],"-",FractionBox[RowBox[{RowBox[
{"(",RowBox[{RowBox[{SuperscriptBox["a","3"]," ",SuperscriptBox["\[ExponentialE]",
RowBox[{"2"," ","a"," ","p"}]]," ",RowBox[{"(",RowBox[{SuperscriptBox["\[ExponentialE]",
RowBox[{"b"," ","p"}]],"+",SuperscriptBox["\[ExponentialE]",RowBox[{"c"," ","p"}]]}],")"}]}],"+",RowBox[
{SuperscriptBox["a","2"]," ",SuperscriptBox["\[ExponentialE]",RowBox[{"a"," ","p"}]]," ",RowBox[
{"(",RowBox[{RowBox[{RowBox[{"-","2"}]," ",SuperscriptBox["\[ExponentialE]",RowBox[
{"a"," ","p"}]]}],"+",SuperscriptBox["\[ExponentialE]",RowBox[{"b"," ","p"}]],"+",SuperscriptBox[
"\[ExponentialE]",RowBox[{"c"," ","p"}]]}],")"}]," ",RowBox[{"(",RowBox[{RowBox[{"b"," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{"b"," ","p"}]]}],"+",RowBox[{"c"," ",SuperscriptBox["\[ExponentialE]",
RowBox[{"c"," ","p"}]]}]}],")"}]}],"+",RowBox[{"a"," ",RowBox[{"(",RowBox[{RowBox[
{RowBox[{"-","6"}]," ","b"," ","c"," ",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[
{"(",RowBox[{"a","+","b","+","c"}],")"}]," ","p"}]]}],"+",RowBox[{SuperscriptBox[
"c","2"]," ",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"(",RowBox[{"a","+","c"}],")"}]," ","p"}]]," ",RowBox[
{"(",RowBox[{SuperscriptBox["\[ExponentialE]",RowBox[{"a"," ","p"}]],"+",SuperscriptBox[
"\[ExponentialE]",RowBox[{"b"," ","p"}]],"-",RowBox[{"2"," ",SuperscriptBox["\[ExponentialE]",
RowBox[{"c"," ","p"}]]}]}],")"}]}],"+",RowBox[{SuperscriptBox["b","2"]," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"(",RowBox[{"a","+","b"}],")"}]," ","p"}]]," ",RowBox[
{"(",RowBox[{SuperscriptBox["\[ExponentialE]",RowBox[{"a"," ","p"}]],"-",RowBox[{"2"," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{"b"," ","p"}]]}],"+",SuperscriptBox["\[ExponentialE]",RowBox[
{"c"," ","p"}]]}],")"}]}]}],")"}]}],"+",RowBox[{RowBox[{"(",RowBox[{RowBox[{"b"," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{"b"," ","p"}]]}],"+",RowBox[{"c"," ",SuperscriptBox["\[ExponentialE]",
RowBox[{"c"," ","p"}]]}]}],")"}]," ",RowBox[{"(",RowBox[{RowBox[{RowBox[{"-","2"}]," ","b"," ","c"," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"(",RowBox[{"b","+","c"}],")"}]," ","p"}]]}],"+",RowBox[
{SuperscriptBox["b","2"]," ",RowBox[{"(",RowBox[{SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"(",RowBox[{"a","+","b"}],")"}]," ","p"}]],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"(",RowBox[{"b","+","c"}],")"}]," ","p"}]]}],")"}]}],"+",RowBox[{SuperscriptBox[
"c","2"]," ",RowBox[{"(",RowBox[{SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[
{"(",RowBox[{"a","+","c"}],")"}]," ","p"}]],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"(",RowBox[{"b","+","c"}],")"}]," ","p"}]]}],")"}]}]}],")"}]}]}],")"}]," ",RowBox[
{"(",RowBox[{RowBox[{SuperscriptBox["a","3"]," ",SuperscriptBox["\[ExponentialE]",
RowBox[{"2"," ","a"," ","q"}]]," ",RowBox[{"(",RowBox[{SuperscriptBox["\[ExponentialE]",
RowBox[{"b"," ","q"}]],"+",SuperscriptBox["\[ExponentialE]",RowBox[{"c"," ","q"}]]}],")"}]}],"+",RowBox[
{SuperscriptBox["a","2"]," ",SuperscriptBox["\[ExponentialE]",RowBox[{"a"," ","q"}]]," ",RowBox[
{"(",RowBox[{RowBox[{RowBox[{"-","2"}]," ",SuperscriptBox["\[ExponentialE]",RowBox[
{"a"," ","q"}]]}],"+",SuperscriptBox["\[ExponentialE]",RowBox[{"b"," ","q"}]],"+",SuperscriptBox[
"\[ExponentialE]",RowBox[{"c"," ","q"}]]}],")"}]," ",RowBox[{"(",RowBox[{RowBox[{"b"," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{"b"," ","q"}]]}],"+",RowBox[{"c"," ",SuperscriptBox["\[ExponentialE]",
RowBox[{"c"," ","q"}]]}]}],")"}]}],"+",RowBox[{"a"," ",RowBox[{"(",RowBox[{RowBox[
{RowBox[{"-","6"}]," ","b"," ","c"," ",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[
{"(",RowBox[{"a","+","b","+","c"}],")"}]," ","q"}]]}],"+",RowBox[{SuperscriptBox[
"c","2"]," ",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"(",RowBox[{"a","+","c"}],")"}]," ","q"}]]," ",RowBox[
{"(",RowBox[{SuperscriptBox["\[ExponentialE]",RowBox[{"a"," ","q"}]],"+",SuperscriptBox[
"\[ExponentialE]",RowBox[{"b"," ","q"}]],"-",RowBox[{"2"," ",SuperscriptBox["\[ExponentialE]",
RowBox[{"c"," ","q"}]]}]}],")"}]}],"+",RowBox[{SuperscriptBox["b","2"]," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"(",RowBox[{"a","+","b"}],")"}]," ","q"}]]," ",RowBox[
{"(",RowBox[{SuperscriptBox["\[ExponentialE]",RowBox[{"a"," ","q"}]],"-",RowBox[{"2"," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{"b"," ","q"}]]}],"+",SuperscriptBox["\[ExponentialE]",RowBox[
{"c"," ","q"}]]}],")"}]}]}],")"}]}],"+",RowBox[{RowBox[{"(",RowBox[{RowBox[{"b"," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{"b"," ","q"}]]}],"+",RowBox[{"c"," ",SuperscriptBox["\[ExponentialE]",
RowBox[{"c"," ","q"}]]}]}],")"}]," ",RowBox[{"(",RowBox[{RowBox[{RowBox[{"-","2"}]," ","b"," ","c"," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"(",RowBox[{"b","+","c"}],")"}]," ","q"}]]}],"+",RowBox[
{SuperscriptBox["b","2"]," ",RowBox[{"(",RowBox[{SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"(",RowBox[{"a","+","b"}],")"}]," ","q"}]],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"(",RowBox[{"b","+","c"}],")"}]," ","q"}]]}],")"}]}],"+",RowBox[{SuperscriptBox[
"c","2"]," ",RowBox[{"(",RowBox[{SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[
{"(",RowBox[{"a","+","c"}],")"}]," ","q"}]],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{RowBox[{"(",RowBox[{"b","+","c"}],")"}]," ","q"}]]}],")"}]}]}],")"}]}]}],")"}]," ",SuperscriptBox[
"\[Eta]","3"]}],RowBox[{"12"," ",SuperscriptBox[RowBox[{"(",RowBox[{SuperscriptBox[
"\[ExponentialE]",RowBox[{"a"," ","p"}]],"+",SuperscriptBox["\[ExponentialE]",RowBox[
{"b"," ","p"}]],"+",SuperscriptBox["\[ExponentialE]",RowBox[{"c"," ","p"}]]}],")"}],
"3"]," ",SuperscriptBox[RowBox[{"(",RowBox[{SuperscriptBox["\[ExponentialE]",RowBox[
{"a"," ","q"}]],"+",SuperscriptBox["\[ExponentialE]",RowBox[{"b"," ","q"}]],"+",SuperscriptBox[
"\[ExponentialE]",RowBox[{"c"," ","q"}]]}],")"}],"3"]}]],"+",RowBox[{"Log","[",RowBox[
{SuperscriptBox["\[ExponentialE]",RowBox[{"a"," ","p"}]],"+",SuperscriptBox["\[ExponentialE]",
RowBox[{"b"," ","p"}]],"+",SuperscriptBox["\[ExponentialE]",RowBox[{"c"," ","p"}]]}],"]"}],"+",RowBox[
{"Log","[",RowBox[{SuperscriptBox["\[ExponentialE]",RowBox[{"a"," ","q"}]],"+",SuperscriptBox[
"\[ExponentialE]",RowBox[{"b"," ","q"}]],"+",SuperscriptBox["\[ExponentialE]",RowBox[
{"c"," ","q"}]]}],"]"}]}],StandardForm],"Output",CellLabel -> "Out[86]= ",ExpressionUUID -> "7d082ab9-0df5-4e64-ac7c-05b4774eafad"]},
Open],ExpressionUUID -> "303e4810-4478-4b33-b893-22fd35aa3eda"],Cell[
CellGroupData[
{Cell[
BoxData[RowBox[{"NthHamiltonian","[",RowBox[{"expf1",",","expg1",",","p",",","q",",","\[Eta]",",","8"}],"]"}]],
"Input",CellLabel -> "In[87]:= ",ExpressionUUID -> "06c57f4a-684c-4720-9741-fd02e59eb5d2"],Cell[
BoxData[
RowBox[{RowBox[{"a"," ",SuperscriptBox["\[ExponentialE]",RowBox[{"b"," ","p"}]]}],"+",RowBox[
{"c"," ",SuperscriptBox["\[ExponentialE]",RowBox[{"d"," ","q"}]]}],"-",RowBox[{FractionBox[
"1","2"]," ","a"," ","b"," ","c"," ","d"," ",SuperscriptBox["\[ExponentialE]",RowBox[
{RowBox[{"b"," ","p"}],"+",RowBox[{"d"," ","q"}]}]]," ","\[Eta]"}],"+",RowBox[{FractionBox[
"1","12"]," ","a"," ",SuperscriptBox["b","2"]," ","c"," ",SuperscriptBox["d","2"]," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"b"," ","p"}],"+",RowBox[{"d"," ","q"}]}]]," ",RowBox[
{"(",RowBox[{RowBox[{"a"," ",SuperscriptBox["\[ExponentialE]",RowBox[{"b"," ","p"}]]}],"+",RowBox[
{"c"," ",SuperscriptBox["\[ExponentialE]",RowBox[{"d"," ","q"}]]}]}],")"}]," ",SuperscriptBox[
"\[Eta]","2"]}],"-",RowBox[{FractionBox["1","12"]," ",SuperscriptBox["a","2"]," ",SuperscriptBox[
"b","3"]," ",SuperscriptBox["c","2"]," ",SuperscriptBox["d","3"]," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"2"," ","b"," ","p"}],"+",RowBox[{"2"," ","d"," ","q"}]}]]," ",SuperscriptBox[
"\[Eta]","3"]}],"-",RowBox[{FractionBox["1","720"]," ","a"," ",SuperscriptBox["b",
"4"]," ","c"," ",SuperscriptBox["d","4"]," ",SuperscriptBox["\[ExponentialE]",RowBox[
{RowBox[{"b"," ","p"}],"+",RowBox[{"d"," ","q"}]}]]," ",RowBox[{"(",RowBox[{RowBox[
{SuperscriptBox["a","3"]," ",SuperscriptBox["\[ExponentialE]",RowBox[{"3"," ","b"," ","p"}]]}],"+",RowBox[
{SuperscriptBox["c","3"]," ",SuperscriptBox["\[ExponentialE]",RowBox[{"3"," ","d"," ","q"}]]}],"-",RowBox[
{"18"," ",SuperscriptBox["a","2"]," ","c"," ",SuperscriptBox["\[ExponentialE]",RowBox[
{RowBox[{"2"," ","b"," ","p"}],"+",RowBox[{"d"," ","q"}]}]]}],"-",RowBox[{"18"," ","a"," ",SuperscriptBox[
"c","2"]," ",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"b"," ","p"}],"+",RowBox[
{"2"," ","d"," ","q"}]}]]}]}],")"}]," ",SuperscriptBox["\[Eta]","4"]}],"+",RowBox[
{FractionBox["1","720"]," ",SuperscriptBox["a","2"]," ",SuperscriptBox["b","5"]," ",SuperscriptBox[
"c","2"]," ",SuperscriptBox["d","5"]," ",SuperscriptBox["\[ExponentialE]",RowBox[
{RowBox[{"2"," ","b"," ","p"}],"+",RowBox[{"2"," ","d"," ","q"}]}]]," ",RowBox[{"(",RowBox[
{RowBox[{"2"," ",SuperscriptBox["a","2"]," ",SuperscriptBox["\[ExponentialE]",RowBox[
{"2"," ","b"," ","p"}]]}],"+",RowBox[{"2"," ",SuperscriptBox["c","2"]," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{"2"," ","d"," ","q"}]]}],"-",RowBox[{"27"," ","a"," ","c"," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"b"," ","p"}],"+",RowBox[{"d"," ","q"}]}]]}]}],")"}]," ",SuperscriptBox[
"\[Eta]","5"]}],"+",FractionBox[RowBox[{"a"," ",SuperscriptBox["b","6"]," ","c"," ",SuperscriptBox[
"d","6"]," ",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"b"," ","p"}],"+",RowBox[
{"d"," ","q"}]}]]," ",RowBox[{"(",RowBox[{RowBox[{SuperscriptBox["a","5"]," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{"5"," ","b"," ","p"}]]}],"+",RowBox[{SuperscriptBox["c",
"5"]," ",SuperscriptBox["\[ExponentialE]",RowBox[{"5"," ","d"," ","q"}]]}],"-",RowBox[
{"81"," ",SuperscriptBox["a","4"]," ","c"," ",SuperscriptBox["\[ExponentialE]",RowBox[
{RowBox[{"4"," ","b"," ","p"}],"+",RowBox[{"d"," ","q"}]}]]}],"+",RowBox[{"432"," ",SuperscriptBox[
"a","3"]," ",SuperscriptBox["c","2"]," ",SuperscriptBox["\[ExponentialE]",RowBox[
{RowBox[{"3"," ","b"," ","p"}],"+",RowBox[{"2"," ","d"," ","q"}]}]]}],"+",RowBox[
{"432"," ",SuperscriptBox["a","2"]," ",SuperscriptBox["c","3"]," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"2"," ","b"," ","p"}],"+",RowBox[{"3"," ","d"," ","q"}]}]]}],"-",RowBox[
{"81"," ","a"," ",SuperscriptBox["c","4"]," ",SuperscriptBox["\[ExponentialE]",RowBox[
{RowBox[{"b"," ","p"}],"+",RowBox[{"4"," ","d"," ","q"}]}]]}]}],")"}]," ",SuperscriptBox[
"\[Eta]","6"]}],"30240"],"-",FractionBox[RowBox[{SuperscriptBox["a","2"]," ",SuperscriptBox[
"b","7"]," ",SuperscriptBox["c","2"]," ",SuperscriptBox["d","7"]," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"2"," ","b"," ","p"}],"+",RowBox[{"2"," ","d"," ","q"}]}]]," ",RowBox[
{"(",RowBox[{RowBox[{"6"," ",SuperscriptBox["a","4"]," ",SuperscriptBox["\[ExponentialE]",
RowBox[{"4"," ","b"," ","p"}]]}],"+",RowBox[{"6"," ",SuperscriptBox["c","4"]," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{"4"," ","d"," ","q"}]]}],"-",RowBox[{"405"," ",SuperscriptBox[
"a","3"]," ","c"," ",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"3"," ","b"," ","p"}],"+",RowBox[
{"d"," ","q"}]}]]}],"+",RowBox[{"1952"," ",SuperscriptBox["a","2"]," ",SuperscriptBox[
"c","2"]," ",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"2"," ","b"," ","p"}],"+",RowBox[
{"2"," ","d"," ","q"}]}]]}],"-",RowBox[{"405"," ","a"," ",SuperscriptBox["c","3"]," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"b"," ","p"}],"+",RowBox[{"3"," ","d"," ","q"}]}]]}]}],")"}]," ",SuperscriptBox[
"\[Eta]","7"]}],"60480"],"-",FractionBox[RowBox[{"a"," ",SuperscriptBox["b","8"]," ","c"," ",SuperscriptBox[
"d","8"]," ",SuperscriptBox["\[ExponentialE]",RowBox[{RowBox[{"b"," ","p"}],"+",RowBox[
{"d"," ","q"}]}]]," ",RowBox[{"(",RowBox[{RowBox[{SuperscriptBox["a","7"]," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{"7"," ","b"," ","p"}]]}],"+",RowBox[{SuperscriptBox["c",
"7"]," ",SuperscriptBox["\[ExponentialE]",RowBox[{"7"," ","d"," ","q"}]]}],"-",RowBox[
{"324"," ",SuperscriptBox["a","6"]," ","c"," ",SuperscriptBox["\[ExponentialE]",RowBox[
{RowBox[{"6"," ","b"," ","p"}],"+",RowBox[{"d"," ","q"}]}]]}],"+",RowBox[{"6696"," ",SuperscriptBox[
"a","5"]," ",SuperscriptBox["c","2"]," ",SuperscriptBox["\[ExponentialE]",RowBox[
{RowBox[{"5"," ","b"," ","p"}],"+",RowBox[{"2"," ","d"," ","q"}]}]]}],"-",RowBox[
{"16400"," ",SuperscriptBox["a","4"]," ",SuperscriptBox["c","3"]," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"4"," ","b"," ","p"}],"+",RowBox[{"3"," ","d"," ","q"}]}]]}],"-",RowBox[
{"16400"," ",SuperscriptBox["a","3"]," ",SuperscriptBox["c","4"]," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"3"," ","b"," ","p"}],"+",RowBox[{"4"," ","d"," ","q"}]}]]}],"+",RowBox[
{"6696"," ",SuperscriptBox["a","2"]," ",SuperscriptBox["c","5"]," ",SuperscriptBox[
"\[ExponentialE]",RowBox[{RowBox[{"2"," ","b"," ","p"}],"+",RowBox[{"5"," ","d"," ","q"}]}]]}],"-",RowBox[
{"324"," ","a"," ",SuperscriptBox["c","6"]," ",SuperscriptBox["\[ExponentialE]",RowBox[
{RowBox[{"b"," ","p"}],"+",RowBox[{"6"," ","d"," ","q"}]}]]}]}],")"}]," ",SuperscriptBox[
"\[Eta]","8"]}],"1209600"]}],StandardForm],"Output",CellLabel -> "Out[87]= ",ExpressionUUID -> "bf32057c-f4fc-4ef9-8e40-aead7d6cd9c3"]},
Open],ExpressionUUID -> "1e326327-0dee-4320-a7b0-e83a288a6f47"]},StyleDefinitions -> "Default.nb",
FrontEndVersion -> "13.1 for Wolfram Cloud 1.63.0.1 (July 14, 2022)"]